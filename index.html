<!DOCTYPE html>
<html>
<head>
    <style>
        .editor {
            width: 90%;
            height: auto;
            border: 1px solid #ccc;
            padding: 10px;
            margin: 10px 0;
            font-size:20px;
            font-family: Arial;
            white-space: pre-wrap;
        }
        button {
            padding: 8px 16px;
            cursor: pointer;
        }
        .word {
            /* text-decoration:underline #ccc; */
            border:1px #ccc solid;
            border-width:0 0 1px 0;
            display: inline;
        }
        .word:hover{
            background-color:#777;
        }
    </style>
</head>
<body>
    <div class="editor" id="editor" contenteditable="true">文章粘贴于此。<br>Paste your passage here.</div>
    <div style="position:fixed;top:0;right:0;background:#ff0;padding:5px">
        <button onclick="colorizeWords()">Mask Randomly</button>
        <input type="range" id="probability" min="0" max="1" step="0.1" value="0.5"
               oninput="document.getElementById('percent').innerText=(this.value)*100+'%'">
        Visible Ratio <span class="percent" id="percent" style="display:inline-block;width:50px">-%</span>
    </div>

    <script>
        const colors = ["#FFF","#000"];
        
        function colorizeWords() {
            const editor = document.getElementById('editor');
            // 获取纯文本内容并分割单词
            let cleartext = editor.innerText;
            // let text=cleartext.replace("<","\&lt;").replace(">","\&gt;").replace("&","&amp;").replace("\n"," <br>")
            editor.innerText=cleartext;
            let text=editor.innerHTML.replace(/\<br\>/g," <br>");
            const words = text.split(/\s+/);
            // console.log(words);
          
            // 清空并重建内容
            
            let color=((prob)=>{let x=0.5;return prob<=0?()=>colors[0]:()=>{x+=Math.random()**(1/prob-1);return colors[(x>=1)?((x-=1),1):0];}})(document.getElementById("probability").value);
            editor.innerHTML = words.map(word => {
                return `<span class="word" style="color:${color()}">${word}</span>`;
            }).join(' '); // 保留原始空格分隔

            // 保持编辑器可编辑状态
            editor.contentEditable = true;
        }
    </script>
</body>
</html>
